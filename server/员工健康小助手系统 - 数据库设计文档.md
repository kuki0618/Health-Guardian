# å‘˜å·¥å¥åº·å°åŠ©æ‰‹ç³»ç»Ÿ - æ•°æ®åº“è®¾è®¡æ–‡æ¡£



## pre & qus:

#### è¡¨è®¾è®¡ï¼š

â€‹	

   1.å‘˜å·¥è¡¨ (`employees`)è®°å½•å‘˜å·¥åŸºæœ¬ä¿¡æ¯

â€‹	`preferences` å–œå¥½å­—æ®µ 

â€‹			**æ¯”å¦‚è®¾ç½®æœŸæœ›è¿åŠ¨æ—¶é—´ è®¾ç½®å–æ°´æ°´é‡è¿™æ ·ï¼Ÿ**

â€‹			ä¹Ÿå¯è®¾ç½®å¥åº·çŠ¶æ€ æ›´æ–¹ä¾¿aiç»™å‡ºå»ºè®®ï¼Ÿï¼ˆAIæˆ‘ä¸æ‡‚ï¼‰

â€‹			æ ¼å¼åšä¸ªJsonï¼Ÿæ¯”å¦‚è¿™æ · : 

â€‹					{"reminder_interval": 60, "goal_daily_steps": 8000, "water_reminder": true}

â€‹	åˆ›å»ºæ—¶é—´å’Œæ›´æ–°æ—¶é—´å­—æ®µä¹Ÿå¯ä¸ä½¿ç”¨ or å†—ä½™



2. æ´»åŠ¨è®°å½•è¡¨ (`activity_logs`)è®°å½•å‘˜å·¥æ´»åŠ¨	

   **æ•°æ®/åˆ†é’Ÿæ¨¡æ‹Ÿè¿›è¡Œæ’å…¥**

   `activity_type` æ´»åŠ¨ç±»å‹å­—æ®µ

   â€‹		å¯ä»¥ç›´æ¥å­˜å­—ç¬¦ä¸²ï¼ˆsit/stand/walk/meeting) 

   â€‹		æˆ–è€…ç”¨æ•°å­—ä»£è¡¨ç‰¹å®šç±»å‹ ï¼ˆ1-sit , 2- stand,.........ï¼‰

   

3. å¥åº·å»ºè®®è®°å½•è¡¨ (`health_recommendations`)

   **è®°å½•AIè¿”å›çš„å»ºè®®æ•°æ®**

   **è¿”å›å»ºè®® and ä¹Ÿå¯ç”¨äºç”Ÿæˆå¥åº·æŠ¥å‘Š**

   è¿”å›ç»™å‘˜å·¥çš„æ•°æ®

   



## ğŸ“Š æ•°æ®å…³ç³»å›¾

```mermaid
erDiagram
    EMPLOYEES {
    
        %% æ ¼å¼ï¼šæ•°æ®ç±»å‹ å­—æ®µå [çº¦æŸ] 
        int employee_id PK
        varchar name
        varchar department
        varchar workstation_id
        text preferences
        timestamp created_at
        timestamp updated_at
    }

    ACTIVITY_LOGS {
        int log_id PK
        int employee_id FK
        varchar activity_type
        datetime start_time
        datetime end_time
        int duration
        timestamp created_at
    }

    HEALTH_RECOMMENDATIONS {
        int recommendation_id PK
        int employee_id FK
        datetime generated_time
        text recommendation_text
        boolean is_notified
        timestamp created_at
    }

    EMPLOYEES ||--o{ EMPLOYEES : "æ ¹æ®IDæŸ¥æ‰¾å‘˜å·¥"
    EMPLOYEES ||--o{ ACTIVITY_LOGS : "è®°å½•å‘˜å·¥è¡Œä¸ºæ´»åŠ¨"
    ACTIVITY_LOGS ||--o{ HEALTH_RECOMMENDATIONS : "ç»™å‡ºandè®°å½•å»ºè®®"
    %%EMPLOYEES ||--o{ HEALTH_RECOMMENDATIONS : "ç»™å‡ºå»ºè®®"
   
```

**æ ¼å¼ï¼šæ•°æ®ç±»å‹ å­—æ®µå [çº¦æŸ]** 

## ğŸ“‹ è¡¨ç»“æ„è¯¦æƒ…

### 1. å‘˜å·¥è¡¨ (`employees`)

**æè¿°**: å­˜å‚¨å‘˜å·¥çš„åŸºæœ¬ä¿¡æ¯å’Œä¸ªäººå¥åº·åå¥½è®¾ç½®

| å­—æ®µå           | æ•°æ®ç±»å‹    | çº¦æŸ                        | é»˜è®¤å€¼                      | æè¿°                   |
| ---------------- | ----------- | --------------------------- | --------------------------- | ---------------------- |
| `employee_id`    | INT         | PRIMARY KEY, AUTO_INCREMENT | -                           | å‘˜å·¥IDï¼Œä¸»é”®           |
| `name`           | VARCHAR(50) | NOT NULL                    | -                           | å‘˜å·¥å§“å               |
| `department`     | VARCHAR(50) | NOT NULL                    | -                           | æ‰€åœ¨éƒ¨é—¨               |
| `workstation_id` | VARCHAR(20) | -                           | NULL                        | å·¥ä½ç¼–å·               |
| `preferences`    | TEXT        | -                           | NULL                        | å¥åº·åå¥½è®¾ç½®(JSONæ ¼å¼) |
| `created_at`     | TIMESTAMP   | -                           | CURRENT_TIMESTAMP           | åˆ›å»ºæ—¶é—´               |
| `updated_at`     | TIMESTAMP   | -                           | CURRENT_TIMESTAMP ON UPDATE | æ›´æ–°æ—¶é—´               |

**ç´¢å¼•**:
- ä¸»é”®: `employee_id`

---

### 2. æ´»åŠ¨è®°å½•è¡¨ (`activity_logs`)

**æè¿°**: è®°å½•å‘˜å·¥çš„è¯¦ç»†æ´»åŠ¨æ•°æ®ï¼Œæ˜¯ç”Ÿæˆå¥åº·å»ºè®®çš„æ ¸å¿ƒä¾æ®

| å­—æ®µå          | æ•°æ®ç±»å‹    | çº¦æŸ                        | é»˜è®¤å€¼            | æè¿°                             |
| --------------- | ----------- | --------------------------- | ----------------- | -------------------------------- |
| `log_id`        | INT         | PRIMARY KEY, AUTO_INCREMENT | -                 | è®°å½•IDï¼Œä¸»é”®                     |
| `employee_id`   | INT         | FOREIGN KEY                 | -                 | å‘˜å·¥IDï¼Œå¤–é”®å…³è”employeesè¡¨      |
| `activity_type` | VARCHAR(20) | NOT NULL                    | -                 | æ´»åŠ¨ç±»å‹(sit/stand/walk/meeting) |
| `start_time`    | DATETIME    | NOT NULL                    | -                 | æ´»åŠ¨å¼€å§‹æ—¶é—´                     |
| `end_time`      | DATETIME    | NOT NULL                    | -                 | æ´»åŠ¨ç»“æŸæ—¶é—´                     |
| `duration`      | INT         | NOT NULL                    | -                 | æ´»åŠ¨æŒç»­æ—¶é—´(ç§’)                 |
| `created_at`    | TIMESTAMP   | -                           | CURRENT_TIMESTAMP | åˆ›å»ºæ—¶é—´                         |

**ç´¢å¼•**:
- ä¸»é”®: `log_id`
- å¤–é”®: `employee_id` REFERENCES `employees(employee_id)`
- æ™®é€šç´¢å¼•: `idx_employee_id` (`employee_id`)
- æ™®é€šç´¢å¼•: `idx_activity_time` (`start_time`, `end_time`)

---

### 3. å¥åº·å»ºè®®è®°å½•è¡¨ (`health_recommendations`)

**æè¿°**: å­˜å‚¨ç³»ç»Ÿç”Ÿæˆçš„å¥åº·å»ºè®®è®°å½•

| å­—æ®µå                | æ•°æ®ç±»å‹  | çº¦æŸ                        | é»˜è®¤å€¼            | æè¿°                        |
| --------------------- | --------- | --------------------------- | ----------------- | --------------------------- |
| `recommendation_id`   | INT       | PRIMARY KEY, AUTO_INCREMENT | -                 | å»ºè®®IDï¼Œä¸»é”®                |
| `employee_id`         | INT       | FOREIGN KEY                 | -                 | å‘˜å·¥IDï¼Œå¤–é”®å…³è”employeesè¡¨ |
| `generated_time`      | DATETIME  | NOT NULL                    | -                 | å»ºè®®ç”Ÿæˆæ—¶é—´                |
| `recommendation_text` | TEXT      | NOT NULL                    | -                 | å»ºè®®å†…å®¹                    |
| `is_notified`         | BOOLEAN   | -                           | FALSE             | æ˜¯å¦å·²é€šçŸ¥å‘˜å·¥              |
| `created_at`          | TIMESTAMP | -                           | CURRENT_TIMESTAMP | åˆ›å»ºæ—¶é—´                    |

**ç´¢å¼•**:
- ä¸»é”®: `recommendation_id`
- å¤–é”®: `employee_id` REFERENCES `employees(employee_id)`
- æ™®é€šç´¢å¼•: `idx_employee_generated` (`employee_id`, `generated_time`)
- æ™®é€šç´¢å¼•: `idx_notification_status` (`is_notified`)

---

## ğŸ”— è¡¨å…³ç³»è¯´æ˜

- **ä¸€å¯¹å¤šå…³ç³»**: 
  - ä¸€ä¸ªå‘˜å·¥ (`employees`) å¯ä»¥æœ‰å¤šæ¡æ´»åŠ¨è®°å½• (`activity_logs`)
  - ä¸€ä¸ªå‘˜å·¥ (`employees`) å¯ä»¥æ”¶åˆ°å¤šæ¡å¥åº·å»ºè®® (`health_recommendations`)

- **å¤–é”®çº¦æŸ**:
  - `activity_logs.employee_id` â†’ `employees.employee_id`
  - `health_recommendations.employee_id` â†’ `employees.employee_id`
  - ä½¿ç”¨ `ON DELETE CASCADE`ï¼Œå½“å‘˜å·¥è¢«åˆ é™¤æ—¶ï¼Œç›¸å…³çš„æ´»åŠ¨è®°å½•å’Œå»ºè®®ä¹Ÿä¼šè¢«è‡ªåŠ¨åˆ é™¤

---

